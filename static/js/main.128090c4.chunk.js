(this["webpackJsonpdelivery-admin"]=this["webpackJsonpdelivery-admin"]||[]).push([[0],{163:function(e,t,n){},164:function(e,t,n){},247:function(e,t,n){"use strict";n.r(t);var a=n(0),s=n(26),c=n.n(s),r=(n(163),n(164),n(69)),i=n(25),l=n(33),u=n.n(l),o=n(58),d=n(34),j=n(251),p=n(253),b=n(256),h=n(255),_=n(31),f=n(145),O=Object(a.createContext)(),m=n(259),x="https://dodoma65.ru",v=function(e){return new Promise((function(t,n){var a=new FileReader;a.readAsDataURL(e),a.onload=function(){return t(a.result)},a.onerror=function(e){return n(e)}}))},g=n(8),w=function(){var e=Object(a.useContext)(O),t=e.getBannerImages,n=e.banner_images,s=e.uploadBannerImages,c=e.changeBannerImages,r=e.getAppTitle,i=e.app_title,l=e.setAppTitle,x=e.saveAppTitle,w=Object(a.useState)(!1),y=Object(d.a)(w,2),N=y[0],S=y[1],T=Object(a.useState)(""),C=Object(d.a)(T,2),k=C[0],I=C[1],E=Object(a.useState)(""),L=Object(d.a)(E,2),P=L[0],A=L[1],F=Object(a.useState)(!1),B=Object(d.a)(F,2),D=B[0],R=B[1];Object(a.useEffect)((function(){R(!0),t(),r().then((function(){R(!1)}))}),[]);var K=function(){var e=Object(o.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.url||t.preview){e.next=4;break}return e.next=3,v(t.originFileObj);case 3:t.preview=e.sent;case 4:I(t.url||t.preview),S(!0),A(t.name||t.url.substring(t.url.lastIndexOf("/")+1));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),G=Object(g.jsxs)("div",{children:[Object(g.jsx)(m.a,{}),Object(g.jsx)("div",{style:{marginTop:8},children:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c"})]});return Object(g.jsxs)("div",{className:"settings",children:[Object(g.jsx)("h3",{children:"\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f \u0434\u043b\u044f \u0440\u0435\u043a\u043b\u0430\u043c\u043d\u043e\u0433\u043e \u0431\u0430\u043d\u043d\u0435\u0440\u0430:"}),Object(g.jsxs)(j.a,{className:"settings__row",children:[Object(g.jsx)(p.a,{listType:"picture-card",fileList:n,onChange:function(e){var t=e.fileList,n=e.file;return c(n,t)},onPreview:K,customRequest:function(e){var t=e.file;return s(t)},children:n.length>=3?null:G}),Object(g.jsx)(b.a,{visible:N,title:P,footer:null,onCancel:function(){return S(!1)},children:Object(g.jsx)("img",{alt:"example",style:{width:"100%"},src:k})})]}),Object(g.jsx)("h3",{children:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f:"}),Object(g.jsx)(j.a,{className:"settings__row settings__title",children:Object(g.jsx)(h.a.Search,{value:i,onChange:function(e){return l(e.target.value)},onSearch:function(){R(!0),x().then((function(){R(!1)}))},enterButton:Object(g.jsxs)(_.a,{type:"default",children:[Object(g.jsx)(f.a,{className:"settings__title_spin",spinning:D}),"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"]})})})]})},y=n(65),N=n(252),S=n(60),T=function(){var e=Object(a.useContext)(O),t=e.clients,n=e.getClients,s=e.setFilteredList,c=e.filtered_clients,i=Object(a.useState)([]),l=Object(d.a)(i,2),u=l[0],o=l[1],p=Object(a.useState)(""),b=Object(d.a)(p,2),h=b[0],f=b[1];Object(a.useEffect)((function(){n()}),[]);var m=function(e,n){f(e),0===e.length?s(t):s(t.filter((function(t){return t[n].includes(e)})))},x={onChange:function(e,t){o(t)},onSelect:function(e,t,n){o(n)},onSelectAll:function(e,t,n){o(t)}},v=[{title:"\u041d\u043e\u043c\u0435\u0440 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430",dataIndex:"client_phone",width:150,filterDropdown:function(e){e.setSelectedKeys,e.selectedKeys,e.confirm,e.clearFilters;return Object(g.jsx)("div",{className:"users_list__columns_wrapper",children:Object(g.jsx)("input",{className:"users_list__columns_input",placeholder:"\u041d\u043e\u043c\u0435\u0440 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430",value:h,onChange:function(e){return m(e.target.value,"client_phone")}})})},fixed:"left"},{title:"PUSH Token",dataIndex:"token",width:350,ellipsis:{showTitle:!1},render:function(e){return Object(g.jsx)(y.a,{placement:"topLeft",title:e,children:e})}},{title:"OS",dataIndex:"os",width:100,filterDropdown:function(e){e.setSelectedKeys,e.selectedKeys,e.confirm,e.clearFilters;return Object(g.jsx)("div",{className:"users_list__columns_wrapper",children:Object(g.jsx)("input",{className:"users_list__columns_input",placeholder:"\u041e\u043f\u0435\u0440\u0430\u0446\u0438\u043e\u043d\u043d\u0430\u044f \u0441\u0438\u0441\u0442\u0435\u043c\u0430",value:h,onChange:function(e){return m(e.target.value,"os")}})})}}];return Object(g.jsxs)("div",{children:[Object(g.jsx)(N.a,{title:function(){return Object(g.jsx)("h3",{children:"\u0421\u043f\u0438\u0441\u043e\u043a \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u0434\u043b\u044f \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0438 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f"})},locale:{emptyText:Object(g.jsx)(S.a,{description:"\u041a\u043b\u0438\u0435\u043d\u0442\u044b \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442"})},showSorterTooltip:!0,size:"small",rowSelection:x,bordered:!0,columns:v,dataSource:c,rowKey:"client_phone",pagination:{pageSize:10}}),Object(g.jsxs)(j.a,{className:"users_list__btn_wrapper",children:[Object(g.jsx)(r.b,{to:{pathname:"/send_push",state:{users_list:u}},children:Object(g.jsx)(_.a,{type:"default",disabled:0===u.length,className:"users_list__send_btn",children:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u0435 \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u043c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\u043c"})}),Object(g.jsx)(r.b,{to:{pathname:"/send_push",state:{users_list:t}},children:Object(g.jsx)(_.a,{type:"primary",className:"users_list__send_btn_primary",children:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u0435  \u0432\u0441\u0435\u043c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\u043c"})})]})]})},C=n(91),k=n(260),I=n(254),E=n(257),L=h.a.TextArea,P=function(){var e=Object(a.useState)(""),t=Object(d.a)(e,2),n=t[0],s=t[1],c=Object(a.useState)(""),r=Object(d.a)(c,2),l=r[0],u=r[1],o=Object(a.useState)(!1),p=Object(d.a)(o,2),b=p[0],f=p[1],m=Object(a.useState)(!1),x=Object(d.a)(m,2),v=x[0],w=x[1],y=Object(a.useContext)(O).sendPush,N=Object(i.f)(),S=N.location,T=N.goBack;return console.log(S.state.users_list),Object(g.jsxs)("div",{children:[Object(g.jsx)("div",{className:"send_push__header",children:Object(g.jsxs)(_.a,{type:"dashed",onClick:function(){return T()},children:[Object(g.jsx)(C.a,{})," \u043d\u0430\u0437\u0430\u0434"]})}),!1===v?Object(g.jsxs)(I.a,{className:"ant-advanced-search-form",children:[Object(g.jsx)(j.a,{className:"send_push__row",children:Object(g.jsx)(h.a,{onChange:function(e){return s(e.target.value)},disabled:b,value:n,placeholder:"\u0417\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f"})}),Object(g.jsx)(j.a,{className:"send_push__row",children:Object(g.jsx)(L,{onChange:function(e){return u(e.target.value)},disabled:b,value:l,placeholder:"\u0422\u0435\u043a\u0441\u0442 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f",rows:4})}),Object(g.jsx)(j.a,{className:"send_push__row",children:Object(g.jsx)(_.a,{onClick:function(){f(!0),y(n,l,S.state.users_list).then((function(){f(!1),w(!0)}))},disabled:0===n.length||0===l.length||b,type:"dashed",children:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u0435"})})]}):Object(g.jsx)(E.a,{icon:Object(g.jsx)(k.a,{twoToneColor:"#52c41a"}),title:"\u0423\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u0435 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043e!",extra:[Object(g.jsx)(_.a,{onClick:function(){return T()},type:"normal",children:"\u0412\u0435\u0440\u043d\u0443\u0442\u044c\u0441\u044f \u043a \u0441\u043f\u0438\u0441\u043a\u0443 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439"},"console")]})]})},A=n(258);var F=function(){return Object(g.jsx)(r.a,{children:Object(g.jsxs)("div",{className:"main",children:[Object(g.jsxs)("nav",{className:"navigation",children:[Object(g.jsx)("div",{className:"nav_header",children:Object(g.jsx)("p",{className:"nav_header__title",children:"\u0414\u043e\u0414\u043e\u043c\u0430"})}),Object(g.jsxs)("ul",{children:[Object(g.jsx)("li",{children:Object(g.jsxs)(r.c,{exact:!0,className:"navigation__base_link",activeClassName:"navigation__active_link",to:"/",children:[Object(g.jsx)("div",{className:"top_radial_devider"}),Object(g.jsxs)("div",{className:"navigation__title_wrapper",children:[Object(g.jsx)(A.a,{className:"navigation__icon"}),"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438"]}),Object(g.jsx)("div",{className:"bottom_radial_devider"})]})}),Object(g.jsx)("li",{children:Object(g.jsxs)(r.c,{exact:!0,className:"navigation__base_link",activeClassName:"navigation__active_link",to:"/push",children:[Object(g.jsx)("div",{className:"top_radial_devider"}),Object(g.jsxs)("div",{className:"navigation__title_wrapper",children:[Object(g.jsx)(A.a,{className:"navigation__icon"}),"\u0423\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f"]}),Object(g.jsx)("div",{className:"bottom_radial_devider"})]})})]})]}),Object(g.jsx)("div",{className:"content",children:Object(g.jsxs)(i.c,{children:[Object(g.jsx)(i.a,{exact:!0,path:"/",children:Object(g.jsx)(w,{})}),Object(g.jsx)(i.a,{path:"/push",children:Object(g.jsx)(T,{})}),Object(g.jsx)(i.a,{path:"/send_push",children:Object(g.jsx)(P,{})})]})})]})})},B=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,261)).then((function(t){var n=t.getCLS,a=t.getFID,s=t.getFCP,c=t.getLCP,r=t.getTTFB;n(e),a(e),s(e),c(e),r(e)}))},D=n(51),R="GET_CLIENTS",K="SET_FILTERED_LIST",G="GET_BANNER_IMAGES",J="SET_APP_TITLE",U={clients:[],pushList:[],banner_images:[],app_title:""};function z(e,t){switch(t.type){case R:return Object(D.a)(Object(D.a)({},e),{},{clients:t.clients});case K:return Object(D.a)(Object(D.a)({},e),{},{filtered_clients:t.filtered_clients});case"GET_PUSH_LIST":return Object(D.a)(Object(D.a)({},e),{},{push_list:t.push_list});case G:return Object(D.a)(Object(D.a)({},e),{},{banner_images:t.banner_images});case J:return Object(D.a)(Object(D.a)({},e),{},{app_title:t.app_title});default:return e}}var H=function(e){var t=e.children,n=Object(a.useReducer)(z,U),s=Object(d.a)(n,2),c=s[0],r=s[1],i=function(){var e=Object(o.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:fetch(x+"/api/clients/get").then((function(e){return e.json()})).then((function(e){r({type:R,clients:e.data}),r({type:K,filtered_clients:e.data})}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),l=function(){var e=Object(o.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:fetch(x+"/api/images/get").then((function(e){return e.json()})).then((function(e){var t=e.data.map((function(e){return e.url=x+e.src,e}));r({type:G,banner_images:t})}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),j=function(){var e=Object(o.a)(u.a.mark((function e(t){var n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t.uid),n=x+"/api/images/upload",(a=new FormData).append("name",t.name),a.append("file",t),a.append("uid",t.uid),e.abrupt("return",fetch(n,{method:"POST",body:a}).then((function(e){return e.json()})).then((function(e){var n=c.banner_images.map((function(e){return e.uid===t.uid&&(e.status="success"),e}));r({type:G,banner_images:n})})).catch((function(e){var n=c.banner_images.map((function(e){return e.uid===t.uid&&(e.status="error"),e}));r({type:G,banner_images:n})})));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=Object(o.a)(u.a.mark((function e(t,n){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("changed",t),"removed"!==t.status){e.next=7;break}return r({type:G,banner_images:n}),a=x+"/api/images/remove?uid="+t.uid,e.abrupt("return",fetch(a));case 7:"uploading"===t.status&&r({type:G,banner_images:n});case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),b=function(){var e=Object(o.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=x+"/api/settings/get",e.abrupt("return",fetch(t).then((function(e){return e.json()})).then((function(e){r({type:J,app_title:e.data.app_main_title})})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),h=function(){var e=Object(o.a)(u.a.mark((function e(t,n,a){var s,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=x+"/api/push/send",c={title:t,description:n,users_list:a},e.abrupt("return",fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)}));case 3:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}();return Object(g.jsx)(O.Provider,{value:{clients:c.clients,filtered_clients:c.filtered_clients,push_list:c.push_list,banner_images:c.banner_images,app_title:c.app_title,getClients:i,setFilteredList:function(e){r({type:K,filtered_clients:e})},getBannerImages:l,uploadBannerImages:j,changeBannerImages:p,getAppTitle:b,setAppTitle:function(e){r({type:J,app_title:e})},saveAppTitle:function(){var e=x+"/api/settings/change?app_main_title="+c.app_title;return fetch(e)},sendPush:h},children:t})},q=n(17),M=n(149),Q=n.n(M);c.a.render(Object(g.jsx)(H,{children:Object(g.jsx)(q.a,{locale:Q.a,children:Object(g.jsx)(F,{})})}),document.getElementById("root")),B()}},[[247,1,2]]]);
//# sourceMappingURL=main.128090c4.chunk.js.map